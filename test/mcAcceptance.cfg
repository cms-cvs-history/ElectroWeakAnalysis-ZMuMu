process MCAcceptance = {
  include "FWCore/MessageLogger/data/MessageLogger.cfi"

  untracked PSet options = {
    untracked bool wantSummary = true  # default is false
  }
                                                  
  untracked PSet maxEvents = {
    untracked int32 input = -1
  }

  source = PoolSource {
    untracked vstring fileNames = {
      '/store/mc/CSA08/Zmumu/GEN-SIM-RECO/1PB_V2_RECO_v1/0028/10375028-DD24-DD11-8170-001617E30F4C.root',
      '/store/mc/CSA08/Zmumu/GEN-SIM-RECO/1PB_V2_RECO_v1/0028/12CA1A34-DB24-DD11-AA5F-001D09F2426D.root',
      '/store/mc/CSA08/Zmumu/GEN-SIM-RECO/1PB_V2_RECO_v1/0028/F037A61F-DC24-DD11-B3F4-000423D98844.root',
      '/store/mc/CSA08/Zmumu/GEN-SIM-RECO/1PB_V2_RECO_v1/0029/3001CA6B-E024-DD11-830E-001D09F292D1.root',
      '/store/mc/CSA08/Zmumu/GEN-SIM-RECO/1PB_V2_RECO_v1/0029/D06BC70D-E124-DD11-BB0A-001D09F25041.root',
      '/store/mc/CSA08/Zmumu/GEN-SIM-RECO/1PB_V2_RECO_v1/0029/D6B9828D-DE24-DD11-AE72-001D09F2432B.root'
    }
  }

  module evtInfo = AsciiOutputModule {
  }

  module zToMuMuMC = CandViewRefSelector {
    InputTag src = genParticles
    string cut = "pdgId = 23 & status = 3 & abs(daughter(0).pdgId) = 13"
  }	

  module dimuons = CandViewShallowCloneCombiner {
    string decay = "muons@+ muons@-"
    string cut = "mass > 0"
    bool checkCharge = true
    string name = "dimuon"
    vstring roles = { 'muon1', 'muon2' }
  }

  module goodMuonMCMatch = MCMatcher {
    InputTag src = muons
    InputTag matched = genParticles
    double maxDeltaR = 0.15
    double maxDPtRel = 1.0
    bool resolveAmbiguities = false
    bool resolveByMatchQuality = false
    bool checkCharge = true
    vint32 mcPdgId = { 13 } # muons
    vint32 mcStatus = { 1 }
  } 

  module dimuonMCMatch = MCTruthCompositeMatcherNew {
    InputTag src = dimuons
    VInputTag matchMaps = { goodMuonMCMatch }
    vint32 matchPDGId = { 23 }
  }

  module mcAcceptance = MCAcceptanceAnalyzer {
    InputTag zToMuMu = dimuons
    InputTag zToMuMuMC = zToMuMuMC
    InputTag mcMap = dimuonMCMatch
    double ptMin = 20
    double etaMax = 2
    double massMin = 60
    double massMax = 120
  }	

  path mcPath = {
    zToMuMuMC,
    dimuons, goodMuonMCMatch, dimuonMCMatch,
    mcAcceptance
  }

  endpath end = {
    evtInfo
  }

}

